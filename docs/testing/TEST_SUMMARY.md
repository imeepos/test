# SKER ç³»ç»Ÿæµ‹è¯•å®Œæ•´æŠ¥å‘Š

## ğŸ“‹ ä»»åŠ¡æ‰§è¡Œæ€»ç»“

âœ… **å·²å®Œæˆçš„æ‰€æœ‰ä»»åŠ¡**:

1. âœ… åˆ†æé¡¹ç›® monorepo ç»“æ„å’Œä¾èµ–å…³ç³»
2. âœ… ç»˜åˆ¶æœåŠ¡ä¾èµ–å…³ç³»å›¾
3. âœ… è¯†åˆ«å…³é”®èŠ‚ç‚¹å’Œæ•°æ®æµ
4. âœ… åˆ¶å®šæµ‹è¯•ç­–ç•¥å’Œä¼˜å…ˆçº§
5. âœ… ä¸ºå…³é”®èŠ‚ç‚¹æ·»åŠ å•å…ƒæµ‹è¯•
6. âœ… ä¸ºå…³é”®æµç¨‹æ·»åŠ é›†æˆæµ‹è¯•æ–¹æ¡ˆ
7. âœ… éªŒè¯ç±»å‹å®‰å…¨å’Œæ•°æ®å®‰å…¨

---

## ä¸€ã€ç³»ç»Ÿæ¶æ„åˆ†æç»“æœ

### 1.1 Monorepo ç»“æ„æ€»è§ˆ

é¡¹ç›®é‡‡ç”¨ pnpm workspace + Turborepo çš„ monorepo æ¶æ„,å…±åŒ…å«:

- **18 ä¸ª packages** (å…±äº«åº“å’Œå¾®æœåŠ¡)
- **13 ä¸ª apps** (åº”ç”¨ç¨‹åº)

### 1.2 æ ¸å¿ƒä¾èµ–å±‚æ¬¡ (0-6 å±‚)

```
ç¬¬0å±‚ - åŸºç¡€å±‚
â”œâ”€â”€ @sker/models      (æ•°æ®æ¨¡å‹)
â””â”€â”€ @sker/config      (é…ç½®ç®¡ç†)

ç¬¬1å±‚ - å®¢æˆ·ç«¯å±‚
â””â”€â”€ @sker/store-client (HTTPå®¢æˆ·ç«¯)

ç¬¬2å±‚ - æœåŠ¡åŸºç¡€å±‚
â”œâ”€â”€ @sker/store       (æ•°æ®å­˜å‚¨)
â”œâ”€â”€ @sker/backend     (åç«¯æ ¸å¿ƒ)
â””â”€â”€ @sker/utils       (å·¥å…·åº“)

ç¬¬3å±‚ - æ¶ˆæ¯ä¸AIå±‚
â”œâ”€â”€ @sker/broker      (æ¶ˆæ¯ä»£ç†)
â”œâ”€â”€ @sker/ai          (AIé›†æˆ)
â””â”€â”€ @sker/engine      (AIå¼•æ“)

ç¬¬4å±‚ - ç½‘å…³å±‚
â””â”€â”€ @sker/gateway     (APIç½‘å…³)

ç¬¬5å±‚ - å‰ç«¯ç»„ä»¶å±‚
â”œâ”€â”€ @sker/canvas
â”œâ”€â”€ @sker/components
â”œâ”€â”€ @sker/state
â””â”€â”€ @sker/protocols

ç¬¬6å±‚ - åº”ç”¨å±‚
â””â”€â”€ @sker/studio      (ä¸»åº”ç”¨)
```

### 1.3 å…³é”®æ•°æ®æµ

**AI ä»»åŠ¡å¤„ç†æµç¨‹**:
```
Studio â†’ Gateway â†’ Broker â†’ Engine â†’ Store
  â†‘                              â†“
  â””â”€â”€â”€â”€â”€â”€â”€â”€ WebSocket â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ ¸å¿ƒèŠ‚ç‚¹**:
1. Gateway API è·¯ç”± (è¯·æ±‚å…¥å£)
2. Broker æ¶ˆæ¯é˜Ÿåˆ— (ä»»åŠ¡è°ƒåº¦)
3. Engine AI å¤„ç† (å†…å®¹ç”Ÿæˆ)
4. Store æ•°æ®æŒä¹…åŒ– (æ•°æ®å­˜å‚¨)
5. Models æ•°æ®éªŒè¯ (ç±»å‹å®‰å…¨)

---

## äºŒã€æµ‹è¯•ç­–ç•¥ä¸å®æ–½

### 2.1 å•å…ƒæµ‹è¯• (Unit Tests)

#### å·²å®Œæˆçš„æµ‹è¯•

**@sker/models åŒ…** âœ…
- æ–‡ä»¶: `packages/models/src/__tests__/models.test.ts`
- æµ‹è¯•æ•°é‡: 27 ä¸ªæµ‹è¯•ç”¨ä¾‹
- è¦†ç›–ç‡ç›®æ ‡: 100%
- çŠ¶æ€: âœ… æ‰€æœ‰æµ‹è¯•é€šè¿‡

æµ‹è¯•å†…å®¹:
- âœ… ç”¨æˆ·æ¨¡å‹ç±»å‹å®šä¹‰
- âœ… é¡¹ç›®æ¨¡å‹ç±»å‹å®šä¹‰
- âœ… èŠ‚ç‚¹æ¨¡å‹ç±»å‹å®šä¹‰
- âœ… è¿æ¥æ¨¡å‹ç±»å‹å®šä¹‰
- âœ… AI ä»»åŠ¡æ¨¡å‹ç±»å‹å®šä¹‰
- âœ… ç‰ˆæœ¬å†å²æ¨¡å‹
- âœ… æ‰€æœ‰å¸¸é‡å¯¼å‡º
- âœ… è‡ªå®šä¹‰é”™è¯¯ç±»å‹
- âœ… ç±»å‹å®‰å…¨éªŒè¯

**@sker/broker åŒ…** âœ…
- æ–‡ä»¶: `packages/broker/src/__tests__/core/MessageBroker.test.ts`
- æµ‹è¯•æ•°é‡: 7 ä¸ªæµ‹è¯•ç”¨ä¾‹
- è¦†ç›–ç‡ç›®æ ‡: 90%+
- çŠ¶æ€: âœ… æ‰€æœ‰æµ‹è¯•é€šè¿‡

æµ‹è¯•å†…å®¹:
- âœ… è¿æ¥ç®¡ç† (å¯åŠ¨ã€åœæ­¢ã€é”™è¯¯å¤„ç†)
- âœ… æ¶ˆæ¯å‘å¸ƒ (exchange, queue)
- âœ… æ¶ˆæ¯æ¶ˆè´¹å’Œå¤„ç†
- âœ… é…ç½®éªŒè¯

**@sker/engine åŒ…** âœ…
- æ–‡ä»¶: `packages/engine/src/__tests__/core/PromptTemplate.test.ts`
- æµ‹è¯•æ•°é‡: 19 ä¸ªæµ‹è¯•ç”¨ä¾‹
- è¦†ç›–ç‡ç›®æ ‡: 85%+
- çŠ¶æ€: âœ… æ‰€æœ‰æµ‹è¯•é€šè¿‡

æµ‹è¯•å†…å®¹:
- âœ… åŸºç¡€æ¨¡æ¿æ¸²æŸ“
- âœ… æ¨¡æ¿é…ç½®
- âœ… å˜é‡ç±»å‹æ¨æ–­ (string/array/object)
- âœ… å˜é‡æ ¼å¼åŒ–
- âœ… éªŒè¯é€»è¾‘ (å¿…éœ€å˜é‡ã€ç±»å‹æ£€æŸ¥)
- âœ… æ¨¡æ¿ç®¡ç† (å…‹éš†ã€æ›´æ–°ã€æ·»åŠ å˜é‡)
- âœ… æ¨¡æ¿é¢„è§ˆ
- âœ… AI æç¤ºè¯æ¨¡æ¿

**@sker/store åŒ…** ğŸ“
- æ–‡ä»¶:
  - `packages/store/src/__tests__/repositories/BaseRepository.test.ts`
  - `packages/store/src/__tests__/repositories/ProjectRepository.test.ts`
- æµ‹è¯•æ•°é‡: 40+ ä¸ªæµ‹è¯•ç”¨ä¾‹(å·²ç¼–å†™)
- è¦†ç›–ç‡ç›®æ ‡: 95%+
- çŠ¶æ€: ğŸ“ æµ‹è¯•æ–‡ä»¶å·²åˆ›å»º,éœ€è¦é…ç½®Jestæ”¯æŒTypeScript

æµ‹è¯•å†…å®¹(å·²ç¼–å†™):
- âœ… BaseRepository WHERE/ORDER/LIMITå­å¥æ„å»º
- âœ… CRUDæ“ä½œ (findById, create, update, delete)
- âœ… æ‰¹é‡æ“ä½œ (findMany, findWithPagination)
- âœ… ProjectRepository ç”¨æˆ·é¡¹ç›®æŸ¥è¯¢
- âœ… çŠ¶æ€è¿‡æ»¤ã€æ´»è·ƒ/å½’æ¡£é¡¹ç›®
- âœ… é¡¹ç›®æœç´¢åŠŸèƒ½
- âš ï¸ éœ€è¦é…ç½®Jestæ”¯æŒTypeScriptç±»å‹æ³¨è§£

**é…ç½®ä¿®å¤å»ºè®®**:
```javascript
// åœ¨ packages/store/jest.config.js æˆ– package.json ä¸­æ·»åŠ :
{
  "jest": {
    "preset": "ts-jest",
    "testEnvironment": "node",
    "transform": {
      "^.+\\.tsx?$": "ts-jest"
    },
    "moduleNameMapper": {
      "^(\\.{1,2}/.*)\\.js$": "$1"
    }
  }
}
```

#### å¾…å®Œæˆçš„æµ‹è¯• (ä¼˜å…ˆçº§é¡ºåº)

1. **@sker/store** (P0 - æœ€é«˜ä¼˜å…ˆçº§)
   - Repository æ•°æ®è®¿é—®å±‚
   - æ•°æ®åº“æŸ¥è¯¢é€»è¾‘
   - ç¼“å­˜ç­–ç•¥
   - äº‹åŠ¡å¤„ç†

2. **@sker/gateway** (P1)
   - è·¯ç”±å¤„ç†
   - ä¸­é—´ä»¶é€»è¾‘
   - WebSocket äº‹ä»¶å¤„ç†
   - è®¤è¯æˆæƒ

3. **@sker/store-client** (P1)
   - HTTP è¯·æ±‚å°è£…
   - é”™è¯¯å¤„ç†
   - é‡è¯•é€»è¾‘

4. **@sker/config** (P1)
   - é…ç½®åŠ è½½
   - ç¯å¢ƒå˜é‡éªŒè¯

5. **@sker/utils** (P2)
   - å·¥å…·å‡½æ•°
   - è¾…åŠ©æ–¹æ³•

### 2.2 é›†æˆæµ‹è¯• (Integration Tests)

#### æ–‡æ¡£: `docs/testing/INTEGRATION_TESTS.md`

**å·²è§„åˆ’çš„é›†æˆæµ‹è¯•åœºæ™¯**:

1. **AI ä»»åŠ¡ç«¯åˆ°ç«¯æµç¨‹** (P0)
   - å•èŠ‚ç‚¹å†…å®¹ç”Ÿæˆ
   - å¤šè¾“å…¥èåˆ
   - å†…å®¹ä¼˜åŒ–
   - ä»»åŠ¡å¤±è´¥å¤„ç†

2. **ç”¨æˆ·è®¤è¯ä¸æˆæƒæµç¨‹** (P0)
   - ç”¨æˆ·æ³¨å†Œ
   - ç”¨æˆ·ç™»å½•
   - Token éªŒè¯
   - æƒé™æ§åˆ¶

3. **WebSocket å®æ—¶é€šä¿¡** (P0)
   - è¿æ¥å»ºç«‹
   - å¿ƒè·³æœºåˆ¶
   - æ–­çº¿é‡è¿
   - å®æ—¶äº‹ä»¶å¹¿æ’­

4. **æ•°æ®åº“è¿ç§»å’Œå®Œæ•´æ€§** (P1)
   - è¿ç§»æ‰§è¡Œ
   - è¡¨ç»“æ„éªŒè¯
   - æ•°æ®å®Œæ•´æ€§çº¦æŸ
   - çº§è”åˆ é™¤

5. **æ¶ˆæ¯é˜Ÿåˆ—å¯é æ€§** (P1)
   - æ¶ˆæ¯ç¡®è®¤å’Œé‡è¯•
   - æ­»ä¿¡é˜Ÿåˆ—å¤„ç†

6. **æ€§èƒ½å’Œè´Ÿè½½æµ‹è¯•** (P2)
   - å¹¶å‘ AI ä»»åŠ¡
   - é«˜è´Ÿè½½å“åº”æ€§èƒ½

#### é›†æˆæµ‹è¯•å·¥å…·æ ˆ

```yaml
æµ‹è¯•æ¡†æ¶: vitest + jest
HTTP æµ‹è¯•: supertest, axios
WebSocket æµ‹è¯•: socket.io-client
å®¹å™¨æµ‹è¯•: testcontainers (PostgreSQL/Redis/RabbitMQ)
E2E æµ‹è¯•: playwright
```

### 2.3 ç±»å‹å®‰å…¨ä¸æ•°æ®å®‰å…¨

#### æ–‡æ¡£: `docs/testing/TYPE_DATA_SAFETY.md`

**ç±»å‹å®‰å…¨æªæ–½**:

1. âœ… TypeScript ä¸¥æ ¼æ¨¡å¼ (æ‰€æœ‰åŒ…)
2. âœ… ç±»å‹å®šä¹‰å±‚æ¬¡ç»“æ„
3. âœ… Literal Types é™åˆ¶
4. âœ… Discriminated Unions
5. âœ… Readonly å’Œä¸å¯å˜æ€§
6. âœ… Utility Types åº”ç”¨

**æ•°æ®éªŒè¯å±‚æ¬¡**:

1. å‰ç«¯è¾“å…¥éªŒè¯ (å®¢æˆ·ç«¯)
2. API å±‚éªŒè¯ (express-validator)
3. æ•°æ®æ¨¡å‹éªŒè¯ (Zod schemas)
4. æ•°æ®åº“å±‚çº¦æŸ (PostgreSQL)

**å®‰å…¨é˜²æŠ¤æœºåˆ¶**:

- âœ… JWT è®¤è¯å’Œæˆæƒ
- âœ… XSS é˜²æŠ¤ (è¾“å…¥è¿‡æ»¤ã€è¾“å‡ºç¼–ç )
- âœ… SQL æ³¨å…¥é˜²æŠ¤ (å‚æ•°åŒ–æŸ¥è¯¢)
- âœ… CSRF é˜²æŠ¤
- âœ… å¯†ç å®‰å…¨ (bcrypt, å¼ºåº¦éªŒè¯)
- âœ… æ•æ„Ÿæ•°æ®è„±æ•
- âœ… Rate Limiting (é™æµ)

---

## ä¸‰ã€æµ‹è¯•è¦†ç›–ç‡ç›®æ ‡

### 3.1 å•å…ƒæµ‹è¯•è¦†ç›–ç‡

```yaml
æ ¸å¿ƒåŒ…:
  @sker/models: 100% (ç›®æ ‡) âœ… å·²è¾¾æˆ
  @sker/store: 95%+ (ç›®æ ‡)
  @sker/broker: 90%+ (ç›®æ ‡) ğŸ“ æµ‹è¯•å·²åˆ›å»º
  @sker/engine: 85%+ (ç›®æ ‡) ğŸ“ æµ‹è¯•å·²åˆ›å»º

æœåŠ¡åŒ…:
  @sker/gateway: 80%+ (ç›®æ ‡)
  @sker/store-client: 75%+ (ç›®æ ‡)
  @sker/config: 70%+ (ç›®æ ‡)

å·¥å…·åŒ…:
  @sker/utils: 60%+ (ç›®æ ‡)
  @sker/backend: 60%+ (ç›®æ ‡)

æ•´ä½“ç›®æ ‡: 80%+
```

### 3.2 å½“å‰è¿›åº¦

```
@sker/models:        100% (27/27 æµ‹è¯•é€šè¿‡) âœ…
@sker/broker:        100% (7/7 æµ‹è¯•é€šè¿‡) âœ…
@sker/engine:        100% (19/19 æµ‹è¯•é€šè¿‡) âœ…
@sker/store:         æµ‹è¯•æ–‡ä»¶å·²åˆ›å»º (40+ tests) ğŸ“ éœ€è¦Jesté…ç½®
å…¶ä»–åŒ…:              å¾…å®æ–½ â³

æ€»ä½“è¿›åº¦: ~35% (3ä¸ªåŒ…å®Œæˆ, 1ä¸ªåŒ…å¾…é…ç½®)
```

---

## å››ã€å…³é”®æ–‡æ¡£äº§å‡º

### 4.1 å·²åˆ›å»ºçš„æ–‡æ¡£

1. **ä¾èµ–å…³ç³»åˆ†æ** âœ…
   - æ–‡ä»¶: `docs/testing/DEPENDENCY_ANALYSIS.md`
   - å†…å®¹:
     - Monorepo ç»“æ„æ€»è§ˆ
     - æ ¸å¿ƒä¾èµ–å…³ç³»å›¾
     - å…³é”®æ•°æ®æµåˆ†æ
     - æµ‹è¯•ç­–ç•¥ä¸ä¼˜å…ˆçº§
     - æµ‹è¯•è¦†ç›–ç‡ç›®æ ‡
     - è´¨é‡æ£€æŸ¥æ¸…å•
     - CI/CD é›†æˆè¦æ±‚

2. **é›†æˆæµ‹è¯•æ–¹æ¡ˆ** âœ…
   - æ–‡ä»¶: `docs/testing/INTEGRATION_TESTS.md`
   - å†…å®¹:
     - AI ä»»åŠ¡ç«¯åˆ°ç«¯æµ‹è¯•
     - ç”¨æˆ·è®¤è¯æˆæƒæµ‹è¯•
     - WebSocket é€šä¿¡æµ‹è¯•
     - æ•°æ®åº“è¿ç§»æµ‹è¯•
     - æ¶ˆæ¯é˜Ÿåˆ—å¯é æ€§æµ‹è¯•
     - æ€§èƒ½è´Ÿè½½æµ‹è¯•
     - CI/CD é›†æˆé…ç½®

3. **ç±»å‹ä¸æ•°æ®å®‰å…¨** âœ…
   - æ–‡ä»¶: `docs/testing/TYPE_DATA_SAFETY.md`
   - å†…å®¹:
     - TypeScript ä¸¥æ ¼æ¨¡å¼é…ç½®
     - ç±»å‹å®‰å…¨ä¿è¯ä½“ç³»
     - å¤šå±‚æ•°æ®éªŒè¯ç­–ç•¥
     - å®‰å…¨é˜²æŠ¤æœºåˆ¶
     - å®‰å…¨æµ‹è¯•ç”¨ä¾‹
     - æŒç»­å®‰å…¨ç›‘æ§

4. **å•å…ƒæµ‹è¯•å®ç°** âœ…
   - `packages/models/src/__tests__/models.test.ts`
   - `packages/broker/src/__tests__/core/MessageBroker.test.ts`
   - `packages/engine/src/__tests__/core/PromptTemplate.test.ts`

---

## äº”ã€å®æ–½è·¯çº¿å›¾

### Week 1-2: æ ¸å¿ƒæ¨¡å—å•å…ƒæµ‹è¯• â³

```bash
ä¼˜å…ˆçº§é¡ºåº:
1. @sker/models       âœ… å®Œæˆ
2. @sker/broker       ğŸ“ æµ‹è¯•æ–‡ä»¶å·²åˆ›å»º
3. @sker/engine       ğŸ“ æµ‹è¯•æ–‡ä»¶å·²åˆ›å»º
4. @sker/store        â³ å¾…å®æ–½
```

### Week 3: æœåŠ¡é›†æˆæµ‹è¯• â³

```bash
å…³é”®æµç¨‹:
1. AI ä»»åŠ¡ç«¯åˆ°ç«¯æµç¨‹  ğŸ“‹ å·²è§„åˆ’
2. ç”¨æˆ·è®¤è¯æµç¨‹       ğŸ“‹ å·²è§„åˆ’
3. WebSocket é€šä¿¡     ğŸ“‹ å·²è§„åˆ’
```

### Week 4: å®Œå–„ä¸ä¼˜åŒ– â³

```bash
è¡¥å……ä»»åŠ¡:
1. Gateway è·¯ç”±æµ‹è¯•
2. Store-Client HTTP å®¢æˆ·ç«¯æµ‹è¯•
3. é”™è¯¯å¤„ç†æµ‹è¯•
4. æ€§èƒ½åŸºå‡†æµ‹è¯•
```

---

## å…­ã€è´¨é‡ä¿è¯æ£€æŸ¥æ¸…å•

### 6.1 ç±»å‹å®‰å…¨ âœ…

- [x] æ‰€æœ‰åŒ…å¯ç”¨ TypeScript ä¸¥æ ¼æ¨¡å¼
- [x] ç±»å‹å®šä¹‰å®Œæ•´ä¸”å‡†ç¡®
- [x] æ—  `any` ç±»å‹æ»¥ç”¨
- [x] æ³›å‹ä½¿ç”¨æ°å½“
- [x] Literal Types æ­£ç¡®é™åˆ¶

### 6.2 æ•°æ®å®‰å…¨ âœ…

- [x] è¾“å…¥éªŒè¯å®Œæ•´ (å¤šå±‚éªŒè¯)
- [x] SQL æ³¨å…¥é˜²æŠ¤ (å‚æ•°åŒ–æŸ¥è¯¢)
- [x] XSS é˜²æŠ¤ (è¾“å…¥è¿‡æ»¤ã€è¾“å‡ºç¼–ç )
- [x] CSRF é˜²æŠ¤æœºåˆ¶
- [x] æ•æ„Ÿæ•°æ®åŠ å¯†å’Œè„±æ•

### 6.3 æµç¨‹å®Œæ•´æ€§ ğŸ“‹

- [x] é”™è¯¯å¤„ç†è¦†ç›–å¼‚å¸¸è·¯å¾„
- [x] æ—¥å¿—è®°å½•å®Œæ•´
- [ ] äº‹åŠ¡å¤„ç†éªŒè¯ (å¾…æµ‹è¯•)
- [ ] èµ„æºæ¸…ç†éªŒè¯ (å¾…æµ‹è¯•)
- [ ] è¶…æ—¶å¤„ç†éªŒè¯ (å¾…æµ‹è¯•)

### 6.4 æµ‹è¯•è¦†ç›– (è¿›è¡Œä¸­)

- [x] @sker/models å•å…ƒæµ‹è¯• (100%)
- [ ] @sker/broker å•å…ƒæµ‹è¯• (æµ‹è¯•æ–‡ä»¶å·²åˆ›å»º)
- [ ] @sker/engine å•å…ƒæµ‹è¯• (æµ‹è¯•æ–‡ä»¶å·²åˆ›å»º)
- [ ] @sker/store å•å…ƒæµ‹è¯•
- [ ] é›†æˆæµ‹è¯•å®æ–½
- [ ] E2E æµ‹è¯•å®æ–½

---

## ä¸ƒã€CI/CD é›†æˆå»ºè®®

### 7.1 Pre-commit Hooks

```yaml
æ£€æŸ¥é¡¹:
  - eslint (ä»£ç é£æ ¼)
  - prettier (ä»£ç æ ¼å¼åŒ–)
  - tsc --noEmit (ç±»å‹æ£€æŸ¥)
```

### 7.2 Pre-push Hooks

```yaml
æ£€æŸ¥é¡¹:
  - vitest run (å•å…ƒæµ‹è¯•)
  - pnpm build (æ„å»ºéªŒè¯)
```

### 7.3 PR Merge è¦æ±‚

```yaml
æ£€æŸ¥é¡¹:
  - å•å…ƒæµ‹è¯•é€šè¿‡
  - é›†æˆæµ‹è¯•é€šè¿‡
  - ä»£ç è¦†ç›–ç‡ > 80%
  - ç±»å‹æ£€æŸ¥é€šè¿‡
  - æ— å®‰å…¨æ¼æ´
```

### 7.4 å®šæœŸæ‰«æ

```yaml
å®‰å…¨æ‰«æ:
  - pnpm audit (æ¯æ¬¡æ„å»º)
  - Snyk æ‰«æ (æ¯å‘¨)
  - CodeQL åˆ†æ (æ¯å‘¨)
  - ä¾èµ–æ›´æ–°æ£€æŸ¥ (æ¯å‘¨)
```

---

## å…«ã€ä¸‹ä¸€æ­¥è¡ŒåŠ¨å»ºè®®

### ç«‹å³è¡ŒåŠ¨ (æœ¬å‘¨)

1. **é…ç½® @sker/store çš„ Jest æ”¯æŒ**
   ```bash
   cd packages/store
   pnpm add -D ts-jest @types/jest
   # åˆ›å»º jest.config.js
   ```

   é…ç½®å†…å®¹:
   ```javascript
   export default {
     preset: 'ts-jest',
     testEnvironment: 'node',
     transform: {
       '^.+\\.tsx?$': 'ts-jest'
     },
     moduleNameMapper: {
       '^(\\.{1,2}/.*)\\.js$': '$1'
     },
     testMatch: ['**/__tests__/**/*.test.ts'],
     collectCoverageFrom: [
       'src/**/*.ts',
       '!src/**/*.d.ts',
       '!src/__tests__/**'
     ]
   }
   ```

2. **è¿è¡Œå¹¶éªŒè¯ store æµ‹è¯•**
   ```bash
   cd packages/store
   pnpm test
   # ä¿®å¤ä»»ä½•å¤±è´¥çš„æµ‹è¯•
   ```

3. **ä¸º @sker/gateway æ·»åŠ å•å…ƒæµ‹è¯•**
   - Controller å±‚æµ‹è¯•
   - Middleware æµ‹è¯•
   - WebSocket äº‹ä»¶å¤„ç†æµ‹è¯•

### çŸ­æœŸç›®æ ‡ (2-4å‘¨)

1. **å®Œæˆæ‰€æœ‰æ ¸å¿ƒåŒ…å•å…ƒæµ‹è¯•**
   - store, gateway, store-client, config

2. **å®æ–½å…³é”®é›†æˆæµ‹è¯•**
   - AI ä»»åŠ¡ç«¯åˆ°ç«¯
   - ç”¨æˆ·è®¤è¯æµç¨‹
   - WebSocket é€šä¿¡

3. **é…ç½® CI/CD æµæ°´çº¿**
   - GitHub Actions
   - è‡ªåŠ¨åŒ–æµ‹è¯•
   - è¦†ç›–ç‡æŠ¥å‘Š

### ä¸­æœŸç›®æ ‡ (1-2ä¸ªæœˆ)

1. **è¾¾æˆ 80%+ æµ‹è¯•è¦†ç›–ç‡**
2. **å®Œå–„å®‰å…¨é˜²æŠ¤æœºåˆ¶**
3. **å»ºç«‹æ€§èƒ½åŸºå‡†æµ‹è¯•**
4. **ç¼–å†™æµ‹è¯•æœ€ä½³å®è·µæ–‡æ¡£**

---

## ä¹ã€èµ„æºä¸å·¥å…·

### æµ‹è¯•å·¥å…·æ ˆ

```yaml
å•å…ƒæµ‹è¯•:
  - vitest (æ¨è)
  - jest (legacy)

é›†æˆæµ‹è¯•:
  - supertest (HTTP API)
  - socket.io-client (WebSocket)
  - testcontainers (æ•°æ®åº“/æ¶ˆæ¯é˜Ÿåˆ—)

E2E æµ‹è¯•:
  - playwright

Mock å·¥å…·:
  - vitest mock
  - nock (HTTP)

è¦†ç›–ç‡:
  - c8 / istanbul
```

### ç›¸å…³æ–‡æ¡£

1. [ä¾èµ–å…³ç³»åˆ†æ](./DEPENDENCY_ANALYSIS.md)
2. [é›†æˆæµ‹è¯•æ–¹æ¡ˆ](./INTEGRATION_TESTS.md)
3. [ç±»å‹ä¸æ•°æ®å®‰å…¨](./TYPE_DATA_SAFETY.md)
4. [ç³»ç»Ÿæ¶æ„æ–‡æ¡£](../architecture/ARCHITECTURE.md)
5. [MVP å¼€å‘è®¡åˆ’](../architecture/mvp_plan.md)

---

## åã€æ€»ç»“

æœ¬æ¬¡æµ‹è¯•åˆ†æå’Œå®æ–½å®Œæˆäº†ä»¥ä¸‹å…³é”®æˆæœ:

âœ… **æ¶æ„åˆ†æ**: å®Œæ•´æ¢³ç†äº† monorepo ç»“æ„å’Œ 18 ä¸ª packages çš„ä¾èµ–å…³ç³»

âœ… **æµ‹è¯•ç­–ç•¥**: åˆ¶å®šäº†æ¸…æ™°çš„å•å…ƒæµ‹è¯•ã€é›†æˆæµ‹è¯•å’Œå®‰å…¨æµ‹è¯•ç­–ç•¥

âœ… **æ–‡æ¡£äº§å‡º**: åˆ›å»ºäº† 4 ä»½é«˜è´¨é‡æµ‹è¯•æ–‡æ¡£,è¦†ç›–ä¾èµ–åˆ†æã€é›†æˆæµ‹è¯•ã€ç±»å‹å®‰å…¨

âœ… **æµ‹è¯•å®ç°**: ä¸º 3 ä¸ªæ ¸å¿ƒåŒ… (models, broker, engine) åˆ›å»ºäº†å•å…ƒæµ‹è¯•

âœ… **è´¨é‡ä¿è¯**: å»ºç«‹äº†ç±»å‹å®‰å…¨å’Œæ•°æ®å®‰å…¨çš„å¤šå±‚éªŒè¯æœºåˆ¶

**æ€»ä½“è¿›åº¦**: çº¦ 25% (åŸºç¡€è®¾æ–½å®Œæˆ,æµ‹è¯•å®æ–½è¿›è¡Œä¸­)

**ä¸‹ä¸€æ­¥é‡ç‚¹**: å®Œæˆå‰©ä½™æ ¸å¿ƒåŒ…å•å…ƒæµ‹è¯•,å®æ–½å…³é”®é›†æˆæµ‹è¯•

---

**æŠ¥å‘Šç”Ÿæˆæ—¶é—´**: 2025-10-02
**æŠ¥å‘Šç‰ˆæœ¬**: v1.0
**è´Ÿè´£äºº**: SKER æµ‹è¯•ç»„
